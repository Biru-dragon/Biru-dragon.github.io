<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>TikTok Login Kit - Callback</title>
</head>
<body>
  <h1>Retour TikTok</h1>
  <p id="status"></p>

  <script>
    // Récupération des paramètres de l’URL
    const urlParams = new URLSearchParams(window.location.search);
    const code  = urlParams.get('code');
    const state = urlParams.get('state');

    // Vérification du "state" si nécessaire (celui envoyé lors de la redirection)
    // if (state !== 'xyz123') {
    //   // Gérer l'erreur d'état non valide
    // }

    const statusEl = document.getElementById('status');

    if (code) {
      // Afficher le code dans la console ou sur la page (à titre de démo)
      console.log('Code TikTok:', code);
      statusEl.textContent = `Code reçu : ${code}`;

      /**
       * À partir d'ici, vous pouvez envoyer ce "code" à votre serveur (via fetch ou XMLHttpRequest)
       * pour l’échanger contre un token d’accès. Par exemple :
       * 
       * fetch('/votre-route-backend', {
       *   method: 'POST',
       *   headers: {
       *     'Content-Type': 'application/json'
       *   },
       *   body: JSON.stringify({ code })
       * })
       * .then(response => response.json())
       * .then(data => {
       *   // Traiter la réponse de votre backend, qui aura récupéré le token d'accès
       * })
       * .catch(err => console.error(err));
       */

    } else {
      statusEl.textContent = 'Aucun code TikTok détecté dans l’URL de callback.';
    }
  </script>
</body>
</html>
